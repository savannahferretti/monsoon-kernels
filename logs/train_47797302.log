Training model: kernel_exponential_vertical
00:09:27 - INFO - Spinning up...
00:09:28 - INFO - Preparing data splits...
00:11:38 - INFO - Common domain constraints: maxradius = 1, maxtimelag = 6
00:11:38 - INFO - Training `kernel_exponential_vertical`...
00:11:56 - INFO -    Training samples: 18245814, Validation samples: 3646518
00:11:56 - INFO -    Training batches: 36492, Validation batches: 7294
wandb: Currently logged in as: savannahferretti (savannah-research) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.21.1
wandb: Run data is saved locally in /global/cfs/cdirs/m4334/sferrett/monsoon-kernels/wandb/run-20260115_001156-91fvgxwb
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run kernel_exponential_vertical
wandb: ‚≠êÔ∏è View project at https://wandb.ai/savannah-research/%20Integration%20Kernel%20Model%20Experiments
wandb: üöÄ View run at https://wandb.ai/savannah-research/%20Integration%20Kernel%20Model%20Experiments/runs/91fvgxwb
Traceback (most recent call last):
  File "/global/homes/s/sferrett/.conda/envs/monsoon-kernels/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/global/homes/s/sferrett/.conda/envs/monsoon-kernels/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-kernels/scripts/models/train.py", line 107, in <module>
    trainer.fit(name,kind,uselocal)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-kernels/scripts/models/classes/trainer.py", line 203, in fit
    trainloss,dataloadtime,computetime = self.train_epoch(uselocal,haskernel)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-kernels/scripts/models/classes/trainer.py", line 106, in train_epoch
    outputvalues = self.model(fieldpatch,dareapatch,dlevpatch,dtimepatch,dlevfull,localvalues)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-kernels/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-kernels/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-kernels/scripts/models/architectures.py", line 120, in forward
    features = self.intkernel(fieldpatch,dareapatch,dlevpatch,dtimepatch,dlevfull)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-kernels/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/global/homes/s/sferrett/.conda/envs/monsoon-kernels/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-kernels/scripts/models/kernels.py", line 577, in forward
    weights = self.get_weights(dareapatch, dlevfull, dtimepatch, fieldpatch.device)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-kernels/scripts/models/kernels.py", line 487, in get_weights
    self.weights = KernelModule.normalize(kernel, dareapatch0, self.dlevfull, dtimepatch0, self.kerneldims)
  File "/global/cfs/cdirs/m4334/sferrett/monsoon-kernels/scripts/models/kernels.py", line 58, in normalize
    assert torch.allclose(checksum, torch.ones_like(checksum), atol=1e-4), \
AssertionError: Kernel normalization failed: weights sum to 0.999952 instead of 1.0
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mkernel_exponential_vertical[0m at: [34mhttps://wandb.ai/savannah-research/%20Integration%20Kernel%20Model%20Experiments/runs/91fvgxwb[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20260115_001156-91fvgxwb/logs[0m
